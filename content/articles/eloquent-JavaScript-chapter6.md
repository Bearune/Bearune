---
category: å‰ç«¯é–‹ç™¼
title: ã€JavaScript å­¸ç¿’ç­†è¨˜ 06ã€‘ç‰©ä»¶å°å‘ Chapter 6 The Secret Life of Objects
description: æ·±å…¥æ·ºå‡ºå­¸ç¿’ JavaScript ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆï¼æœ¬ç³»åˆ—å…§å®¹æ˜¯åŸºæ–¼ Eloquent JavaScript 4th edition (2024) æ‰€æ•´ç†çš„ç²¾ç°¡ç­†è¨˜ã€‚æœ¬ç¯‡ç­†è¨˜å¾ç‰©ä»¶å°å‘çš„åŸºæœ¬æ€ç¶­å‡ºç™¼ï¼Œæ¢è¨å°è£ã€ç¹¼æ‰¿ã€å¤šå‹ç­‰æ ¸å¿ƒç‰¹æ€§çš„é‡è¦æ€§ï¼Œä¸¦æ·±å…¥ä»‹ç´¹ JavaScript ä¸­é¡åˆ¥èˆ‡ç‰©ä»¶çš„æ¦‚å¿µèˆ‡æ‡‰ç”¨ã€‚å…§å®¹åŒ…å«ç‰©ä»¶å°å‘çš„åŸºç¤è§€å¿µã€JavaScript ç‰¹æœ‰çš„åŸå‹ç¹¼æ‰¿ç³»çµ±ï¼Œä»¥åŠç¾ä»£ JavaScript ä¸­ Map å’Œ Symbol çš„å¯¦éš›æ‡‰ç”¨æ¡ˆä¾‹ï¼Œå¹«åŠ©ä½ æŒæ¡ JavaScript ä¸­ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆçš„æŠ€å·§ã€‚å¾åŸºç¤è§€å¿µåˆ°å¯¦å‹™æ‡‰ç”¨ï¼Œå¾ªåºæ¼¸é€²åœ°å­¸ç¿’å¦‚ä½•é‹ç”¨ç‰©ä»¶å°å‘çš„æ–¹æ³•ä¾†çµ„ç¹”ç¨‹å¼ç¢¼ï¼Œæå‡ç¨‹å¼çš„å¯ç¶­è­·æ€§èˆ‡æ“´å±•æ€§ã€‚
tags: ['javascript', 'Eloquent JavaScript å­¸ç¿’ç­†è¨˜ç³»åˆ—']
date: 2025-01-09
keywords: JavaScript ç‰©ä»¶å°å‘, JavaScript é¡åˆ¥, JavaScript ç‰©ä»¶, JavaScript ç¹¼æ‰¿, JavaScript å¤šå‹, JavaScript å°è£, JavaScript åŸå‹, JavaScript åŸå‹éˆ, JavaScript this, JavaScript constructor, JavaScript å»ºæ§‹å­, JavaScript å¯¦ä¾‹, JavaScript Map, JavaScript Symbol, JavaScript ç‰©ä»¶æ–¹æ³•, JavaScript éœæ…‹æ–¹æ³•, JavaScript getter, JavaScript setter, JavaScript å­˜å–å™¨, JavaScript class, JavaScript é¡åˆ¥ç¹¼æ‰¿, JavaScript extends, JavaScript super, JavaScript instanceof, JavaScript new é‹ç®—å­, JavaScript ç‰©ä»¶è¤‡è£½, JavaScript ç‰©ä»¶å±¬æ€§, JavaScript ç§æœ‰å±¬æ€§, JavaScript ç¨‹å¼è¨­è¨ˆ, JavaScript æœ€ä½³å¯¦è¸, JavaScript å­¸ç¿’ç­†è¨˜, JavaScript å…¥é–€æ•™å­¸, JavaScript ç¯„ä¾‹, Eloquent JavaScript, Object-oriented Programming, JavaScript OOP, JavaScript examples
image: /img/articles/eloquent-JavaScript/cover6.webp
draft: false

head:
  - - meta
    - property: og:title
      content: ã€JavaScript å­¸ç¿’ç­†è¨˜ 06ã€‘ç‰©ä»¶å°å‘ Chapter 6 The Secret Life of Objects
  - - meta
    - property: og:type
      content: article
  - - meta
    - property: og:image
      content: https://bearune.com/img/articles/eloquent-JavaScript/cover6.webp
  - - meta
    - property: og:url
      content: https://bearune.com/articles/eloquent-javascript-chapter6
  - - meta
    - property: og:description
      content: æ·±å…¥æ·ºå‡ºå­¸ç¿’ JavaScript ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆï¼æœ¬ç³»åˆ—å…§å®¹æ˜¯åŸºæ–¼ Eloquent JavaScript 4th edition (2024) æ‰€æ•´ç†çš„ç²¾ç°¡ç­†è¨˜ã€‚æœ¬ç¯‡ç­†è¨˜å¾ç‰©ä»¶å°å‘çš„åŸºæœ¬æ€ç¶­å‡ºç™¼ï¼Œæ¢è¨å°è£ã€ç¹¼æ‰¿ã€å¤šå‹ç­‰æ ¸å¿ƒç‰¹æ€§çš„é‡è¦æ€§ï¼Œä¸¦æ·±å…¥ä»‹ç´¹ JavaScript ä¸­é¡åˆ¥èˆ‡ç‰©ä»¶çš„æ¦‚å¿µèˆ‡æ‡‰ç”¨ã€‚å…§å®¹åŒ…å«ç‰©ä»¶å°å‘çš„åŸºç¤è§€å¿µã€JavaScript ç‰¹æœ‰çš„åŸå‹ç¹¼æ‰¿ç³»çµ±ï¼Œä»¥åŠç¾ä»£ JavaScript ä¸­ Map å’Œ Symbol çš„å¯¦éš›æ‡‰ç”¨æ¡ˆä¾‹ï¼Œå¹«åŠ©ä½ æŒæ¡ JavaScript ä¸­ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆçš„æŠ€å·§ã€‚å¾åŸºç¤è§€å¿µåˆ°å¯¦å‹™æ‡‰ç”¨ï¼Œå¾ªåºæ¼¸é€²åœ°å­¸ç¿’å¦‚ä½•é‹ç”¨ç‰©ä»¶å°å‘çš„æ–¹æ³•ä¾†çµ„ç¹”ç¨‹å¼ç¢¼ï¼Œæå‡ç¨‹å¼çš„å¯ç¶­è­·æ€§èˆ‡æ“´å±•æ€§ã€‚

sitemap:
  loc: /articles/eloquent-javascript-chapter6
  lastmod: 2025-01-09
  changefreq: monthly
  priority: 0.5
---

æœ¬ç³»åˆ—å…§å®¹æ˜¯åŸºæ–¼ [Eloquent JavaScript 4th edition (2024)](https://eloquentjavascript.net/){target="_blank"} æ‰€æ•´ç†çš„ç²¾ç°¡ç­†è¨˜ã€‚

> An abstract data type is realized by writing a special kind of program [â€¦] which defines the type in terms of the operations which can be performed on it.â”€â”€ Barbara Liskov, Programming with Abstract Data Types

![ã€JavaScript å­¸ç¿’ç­†è¨˜ 06ã€‘ç‰©ä»¶å°å‘ Chapter 6 The Secret Life of Objects](/img/articles/eloquent-JavaScript/cover6.webp)

æœ¬æ–‡æ·±å…¥æ¢è¨ JavaScript ä¸­ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆçš„æ ¸å¿ƒæ¦‚å¿µï¼Œå¾åŸºç¤çš„é¡åˆ¥èˆ‡ç‰©ä»¶å®šç¾©ï¼Œåˆ°é€²éšçš„ç¹¼æ‰¿æ©Ÿåˆ¶èˆ‡å¤šå‹æ‡‰ç”¨ã€‚é€éå¯¦éš›çš„ç¨‹å¼ç¢¼ç¯„ä¾‹ï¼Œèªªæ˜å¦‚ä½•é‹ç”¨å°è£ã€ç¹¼æ‰¿ã€å¤šå‹ç­‰ç‰©ä»¶å°å‘çš„é‡è¦ç‰¹æ€§ä¾†çµ„ç¹”å’Œç®¡ç†ç¨‹å¼ç¢¼ã€‚åŒæ™‚ä¹Ÿä»‹ç´¹äº† JavaScript ç‰¹æœ‰çš„åŸå‹ç³»çµ±ï¼Œä»¥åŠ `Map`ã€`Symbol` ç­‰ç¾ä»£ JavaScript çš„é‡è¦åŠŸèƒ½ã€‚

:anchor

## ç‰©ä»¶å°å‘åŸºç¤æ¦‚å¿µ

ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆï¼ˆObject-Oriented Programming, OOPï¼‰æ˜¯ä¸€ç¨®ä»¥ã€Œç‰©ä»¶ã€ç‚ºä¸­å¿ƒçš„ç¨‹å¼è¨­è¨ˆæ–¹æ³•ã€‚å®ƒåŒ…å«å››å€‹æ ¸å¿ƒæ¦‚å¿µï¼šç‰©ä»¶å°å‘æ€ç¶­ä½œç‚ºåŸºç¤ï¼Œå°è£ã€ç¹¼æ‰¿ã€å¤šå‹ä½œç‚ºä¸‰å¤§ç‰¹æ€§ï¼ŒæŠ½è±¡è³‡æ–™é¡å‹ä½œç‚ºè¨­è¨ˆæ–¹æ³•ï¼Œä»¥åŠç‰©ä»¶èˆ‡é¡åˆ¥ä½œç‚ºå¯¦ç¾æ‰‹æ®µã€‚é€™äº›æ¦‚å¿µç›¸äº’é—œè¯ï¼Œå…±åŒæ§‹æˆäº†å®Œæ•´çš„ç‰©ä»¶å°å‘é«”ç³»ã€‚

![OOPåŸºç¤æ¦‚å¿µæ¶æ§‹](/img/articles/eloquent-JavaScript/OOPåŸºç¤æ¦‚å¿µæ¶æ§‹.svg)


#### 1. ç‰©ä»¶å°å‘æ€ç¶­

ç‰©ä»¶å°å‘æ€ç¶­æ˜¯æ•´å€‹ OOP çš„æ ¸å¿ƒç†å¿µã€‚å®ƒæ•™å°æˆ‘å€‘ç”¨ç‰©ä»¶çš„æ–¹å¼æ€è€ƒå•é¡Œï¼Œå°‡ç¾å¯¦ä¸–ç•Œçš„å¯¦é«”å°æ‡‰åˆ°ç¨‹å¼ä¸­çš„ç‰©ä»¶ï¼Œé€™æ¨£çš„æ€ç¶­æ–¹å¼è®“ç¨‹å¼è¨­è¨ˆæ›´ç›´è§€ã€æ›´å®¹æ˜“ç†è§£å’Œç¶­è­·ã€‚

##### ä¾‹å­ï¼šæŠŠæœæ±æ©Ÿæƒ³åƒæˆä¸€å€‹ç‰©ä»¶

ä»¥æœæ±æ©Ÿç‚ºä¾‹ï¼Œå®ƒå…§éƒ¨é›–ç„¶åŒ…å«è¤‡é›œçš„æ©Ÿæ¢°çµæ§‹å’Œé›»è·¯è¨­è¨ˆï¼Œä½†è£½é€ å•†å°‡é€™äº›å°ˆæ¥­çŸ¥è­˜éƒ½éš±è—åœ¨ç°¡æ½”çš„å¤–æ®¼ä¹‹ä¸‹ã€‚ä½¿ç”¨è€…åªéœ€è¦çŸ¥é“å¦‚ä½•æ“ä½œå¹¾å€‹æŒ‰éˆ•ï¼Œå°±èƒ½è¼•é¬†æ‰“å‡ºä¸€æ¯æœæ±ï¼Œå®Œå…¨ä¸å¿…äº†è§£å…§éƒ¨çš„é‹ä½œåŸç†ã€‚åªæä¾›ç°¡å–®çš„æ“ä½œä»‹é¢ï¼Œæ—¢æé«˜äº†ä½¿ç”¨æ•ˆç‡ï¼Œä¹Ÿé¿å…äº†ä¸å¿…è¦çš„è¤‡é›œåº¦ã€‚ç•¢ç«Ÿæ¯å€‹æƒ³æ‰“æœæ±çš„äººè‹¥æ˜¯éƒ½è¦å…ˆå­¸ç¿’ææ–™ç§‘å­¸å’Œé›»å­¸ï¼Œé‚£é€™æœæ±ä¸å–ä¹Ÿç½·ï¼ˆç¿»æ¡Œï¼‰ã€‚

> åœ¨ JavaScript ä¸­ï¼Œé™¤äº†åŸºæœ¬å‹åˆ¥ï¼ˆprimitive typesï¼‰å¤–ï¼Œå¹¾ä¹æ‰€æœ‰æ±è¥¿éƒ½æ˜¯ç‰©ä»¶ï¼ŒåŒ…æ‹¬å‡½æ•¸ã€é™£åˆ—ã€å­—ä¸²ç­‰ã€‚

#### 2. å°è£ã€ç¹¼æ‰¿ã€å¤šå‹

##### 2.1 å°è£ï¼ˆEncapsulationï¼‰

æŠŠè¤‡é›œçš„å…§éƒ¨å¯¦ä½œéš±è—èµ·ä¾†ï¼Œåªæä¾›ç°¡å–®çš„æ“ä½œä»‹é¢ï¼Œå°±åƒä½¿ç”¨é›»è¦–æ™‚åªè¦æœƒæŒ‰é™æ§å™¨å°±å¥½ï¼Œä¸éœ€è¦æ‡‚å¾—é›»è¦–å…§éƒ¨çš„é›»è·¯è¨­è¨ˆã€‚

##### 2.2 ç¹¼æ‰¿ï¼ˆInheritanceï¼‰

è®“æ–°é¡åˆ¥å¯ä»¥ç¹¼æ‰¿ç¾æœ‰é¡åˆ¥çš„ç‰¹æ€§ï¼Œå°±åƒç‹—å’Œè²“ï¼ˆæ–°é¡åˆ¥ï¼‰éƒ½ç¹¼æ‰¿äº†å‹•ç‰©ï¼ˆç¾æœ‰é¡åˆ¥ï¼‰çš„åŸºæœ¬ç‰¹å¾µï¼ˆæœ‰ç”Ÿå‘½ã€æœƒå‘¼å¸ã€éœ€è¦åƒæ±è¥¿ç­‰ï¼‰ï¼Œä½†å„è‡ªåˆæœ‰è‡ªå·±ç¨ç‰¹çš„è¡Œç‚ºã€‚

##### 2.3 å¤šå‹ï¼ˆPolymorphismï¼‰

åŒæ¨£çš„æ“ä½œæ–¹å¼å¯ä»¥æ‡‰ç”¨åœ¨ä¸åŒé¡å‹çš„ç‰©ä»¶ä¸Šï¼Œå°±åƒ`æŒ‰ä¸‹é–‹é—œ`é€™å€‹å‹•ä½œå¯ä»¥ç”¨åœ¨é›»ç‡ˆã€é›»æ‰‡ã€é›»è¦–ç­‰ä¸åŒé›»å™¨ä¸Šï¼Œé›–ç„¶æ¯å€‹é›»å™¨æ‰“é–‹å¾Œçš„è¡Œç‚ºéƒ½ä¸åŒã€‚

::info
é€™ä¸‰å€‹æ¦‚å¿µåˆåœ¨ä¸€èµ·å°±æ§‹æˆäº†ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆçš„æ ¸å¿ƒï¼š

- å°è£ï¼šéš±è—è¤‡é›œæ€§ï¼Œæä¾›ç°¡å–®ä»‹é¢
- ç¹¼æ‰¿ï¼šé‡ç”¨ç¾æœ‰ç¨‹å¼ç¢¼ï¼Œå»ºç«‹é¡åˆ¥éšå±¤
- å¤šå‹ï¼šç”¨çµ±ä¸€çš„æ–¹å¼è™•ç†ä¸åŒé¡å‹çš„ç‰©ä»¶
::

åœ¨ç†è§£äº†ç‰©ä»¶å°å‘çš„åŸºæœ¬æ€ç¶­å’Œä¸‰å¤§ç‰¹æ€§å¾Œï¼Œæˆ‘å€‘éœ€è¦ä¸€å€‹æ–¹æ³•ä¾†çµ„ç¹”å’Œè¨­è¨ˆæˆ‘å€‘çš„ç¨‹å¼ã€‚é€™å°±æ˜¯æŠ½è±¡è³‡æ–™é¡å‹çš„æ¦‚å¿µâ€¦â€¦

#### 3. æŠ½è±¡è³‡æ–™é¡å‹ï¼ˆAbstract Data Typesï¼‰

æŠ½è±¡è³‡æ–™é¡å‹ï¼ˆADTï¼‰æ˜¯ä¸€ç¨®ç¨‹å¼è¨­è¨ˆçš„çµ„ç¹”å–®ä½ï¼Œå®ƒè‘—é‡æ–¼ï¼š

âœ… å®šç¾©ã€Œæ˜¯ä»€éº¼ã€å’Œã€Œèƒ½åšä»€éº¼ã€  
âŒ ä¸ç®¡ã€Œæ€éº¼åšåˆ°ã€

å…·é«”ä¾†èªªï¼ŒADT å®šç¾©äº†ï¼š

1. ä¸€çµ„è³‡æ–™çš„æœ¬è³ª
2. é€™äº›è³‡æ–™å¯ä»¥åŸ·è¡Œçš„æ“ä½œï¼ˆä»‹é¢ï¼‰
3. ä¸æ¶‰åŠå…·é«”å¯¦ä½œç´°ç¯€

::info

**ğŸ’¡ ç¶“å…¸ç¯„ä¾‹ï¼šå †ç–Šï¼ˆStackï¼‰**  
- å®ƒå®šç¾©äº†ä»€éº¼æ˜¯å †ç–Šï¼ˆå¾Œé€²å…ˆå‡ºçš„è³‡æ–™çµæ§‹ï¼‰
- å®ƒå®šç¾©äº†å¯ä»¥å°å †ç–Šåšä»€éº¼æ“ä½œï¼ˆpushã€popã€peekï¼‰
- ä½†å®ƒä¸é—œå¿ƒé€™äº›æ“ä½œæ˜¯ç”¨é™£åˆ—é‚„æ˜¯éˆè¡¨ä¾†å¯¦ç¾çš„
::

::info
**ADT èˆ‡ç‰©ä»¶å°å‘çš„é—œä¿‚**

- æä¾›å®šç¾©é¡åˆ¥ä»‹é¢çš„æ–¹æ³•
- æ”¯æ´è³‡æ–™æŠ½è±¡åŒ–çš„æ¦‚å¿µ
- å¹«åŠ©å¯¦ç¾å°è£åŸå‰‡
::

æœ‰äº†æŠ½è±¡è³‡æ–™é¡å‹çš„æ¦‚å¿µï¼Œæˆ‘å€‘ä¾†çœ‹çœ‹å¦‚ä½•ç”¨é¡åˆ¥å’Œç‰©ä»¶ä¾†å…·é«”å¯¦ç¾é€™äº›æŠ½è±¡æ¦‚å¿µâ€¦â€¦

#### 4. é¡åˆ¥èˆ‡ç‰©ä»¶

é¡åˆ¥ï¼ˆClassï¼‰æ˜¯ä¸€å€‹æ¨¡æ¿æˆ–è—åœ–ï¼Œè€Œç‰©ä»¶ï¼ˆObjectï¼‰æ˜¯æ ¹æ“šé€™å€‹æ¨¡æ¿å‰µå»ºå‡ºä¾†çš„å¯¦ä¾‹ï¼Œé€™ç¨®é—œä¿‚æ”¯æ´äº†ç¨‹å¼ç¢¼çš„é‡ç”¨å’Œçµ„ç¹”ï¼Œæ˜¯ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆçš„åŸºçŸ³ã€‚


::info
ä»¥ç°¡å–®çš„æ¯”å–»ä¾†èªªï¼š
- é¡åˆ¥ ï¼ å‹•ç‰©ç¨®é¡ï¼ˆè²“ï¼‰
- ç‰©ä»¶ ï¼ å…·é«”çš„å‹•ç‰©å€‹é«”ï¼ˆå°é»‘ã€å¤§æ©˜ç­‰ï¼‰
::

- ä¸€å€‹é¡åˆ¥å¯ä»¥æœ‰å¤šå€‹ç‰©ä»¶ï¼ˆè²“é€™å€‹ç‰©ç¨®å¯ä»¥æœ‰å¾ˆå¤šéš»å…·é«”çš„è²“ï¼‰
- æ¯å€‹ç‰©ä»¶éƒ½æœ‰è‡ªå·±çš„å±¬æ€§ï¼Œä½†å…±äº«é¡åˆ¥å®šç¾©çš„æ–¹æ³•ï¼ˆæ¯éš»è²“éƒ½æœ‰è‡ªå·±çš„å¹´é½¡ã€æ¯›è‰²ï¼Œä½†æ˜¯æ‰€æœ‰çš„è²“éƒ½æœƒã€Œå–µå–µå«ã€ï¼‰ã€‚
- ç‰©ä»¶æ˜¯é¡åˆ¥çš„å¯¦ä¾‹åŒ–çµæœï¼Œä»£è¡¨äº†çœŸå¯¦ä¸–ç•Œä¸­çš„å…·é«”äº‹ç‰©ï¼ˆçœŸå¯¦å­˜åœ¨çš„æŸä¸€éš»è²“ï¼‰

```javascript
// è²“çš„é¡åˆ¥ï¼ˆå®šç¾©äº†æ‰€æœ‰è²“çš„å…±åŒç‰¹å¾µï¼‰
class Cat {
    constructor(name, color, age) {
        this.name = name;    // åå­—ï¼ˆå±¬æ€§ï¼‰
        this.color = color;  // æ¯›è‰²ï¼ˆå±¬æ€§ï¼‰
        this.age = age;      // å¹´é½¡ï¼ˆå±¬æ€§ï¼‰
    }
    meow() {                 // æ‰€æœ‰çš„è²“éƒ½æœƒå–µå–µå«ï¼ˆå…±äº«çš„æ–¹æ³•ï¼‰
        return `${this.name}ï¼šå–µå–µï¼`;
    }
}
// å‰µå»ºä¸åŒçš„è²“ï¼ˆç‰©ä»¶ï¼‰
const blackCat = new Cat("å°é»‘", "é»‘è‰²", 3);
const whiteCat = new Cat("å°èŠ±", "ç™½è‰²", 2);
console.log(blackCat.meow()); // è¼¸å‡ºï¼šå°é»‘ï¼šå–µå–µï¼
console.log(whiteCat.meow()); // è¼¸å‡ºï¼šå°èŠ±ï¼šå–µå–µï¼
```

#### å°çµ

::info
é€™å››å€‹æ¦‚å¿µå½¢æˆäº†ä¸€å€‹å®Œæ•´çš„é«”ç³»ï¼š

1. ç‰©ä»¶å°å‘æ€ç¶­å¹«åŠ©æˆ‘å€‘ä»¥ç‰©ä»¶çš„æ–¹å¼æ€è€ƒå•é¡Œ
2. ä¸‰å¤§ç‰¹æ€§ï¼ˆå°è£ã€ç¹¼æ‰¿ã€å¤šå‹ï¼‰æä¾›å¯¦ç¾æ©Ÿåˆ¶
3. æŠ½è±¡è³‡æ–™é¡å‹æä¾›äº†é«˜å±¤æ¬¡çš„è¨­è¨ˆæ–¹æ³•
4. ç‰©ä»¶èˆ‡é¡åˆ¥å‰‡æä¾›å…·é«”çš„ç¨‹å¼å¯¦ç¾æ–¹å¼
::


## é¡åˆ¥èˆ‡ç‰©ä»¶çš„å¯¦ä½œ

æƒ³åƒæˆ‘å€‘è¦å‰µå»ºä¸€å€‹ã€Œè²“å’ªæ¨¡æ“¬å™¨ã€ï¼Œéœ€è¦æœ‰å¾ˆå¤šä¸åŒçš„è²“å’ªï¼Œæ¯éš»éƒ½æœ‰è‡ªå·±çš„ç‰¹æ€§å’Œè¡Œç‚ºã€‚é€™å°±æ˜¯ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆ(OOP)çš„æ ¸å¿ƒæ€æƒ³â”€â”€ä½¿ç”¨ç‰©ä»¶ä½œç‚ºç¨‹å¼çš„çµ„ç¹”å–®ä½ã€‚

![é¡åˆ¥èˆ‡ç‰©ä»¶å¯¦ä½œæ¶æ§‹](/img/articles/eloquent-JavaScript/é¡åˆ¥èˆ‡ç‰©ä»¶å¯¦ä½œæ¶æ§‹.svg)

#### 1. é¡åˆ¥å®šç¾© (Class Definition)

é¡åˆ¥å°±åƒæ˜¯ä¸€å€‹ã€Œè²“å’ªè£½é€ èªªæ˜æ›¸ã€ï¼Œå®šç¾©äº†ï¼š

- è²“å’ªæ‡‰è©²å…·å‚™ä»€éº¼ç‰¹å¾µï¼ˆå±¬æ€§ï¼‰
- è²“å’ªèƒ½åšä»€éº¼äº‹æƒ…ï¼ˆæ–¹æ³•ï¼‰

```javascript
class Cat {
  constructor(name, color) {
    this.name = name; // ç‰¹å¾µï¼šåå­—
    this.color = color; // ç‰¹å¾µï¼šæ¯›è‰²
  }
  
  meow() { // è¡Œç‚ºï¼šå«è²
    console.log('å–µï½');
  }
}
```

- ä½¿ç”¨ `class` é—œéµå­—å®šç¾©é¡åˆ¥ï¼ˆè²“ï¼‰
- ä½¿ç”¨æ§‹é€ å‡½æ•¸ `constructor` ä¾†åˆå§‹åŒ–æ–°ç‰©ä»¶ï¼ˆåå­—ã€æ¯›è‰²ï¼‰
- æ–¹æ³•ç›´æ¥å®šç¾©åœ¨é¡åˆ¥ä¸­ï¼ˆè²“å’ªè¡Œç‚ºï¼‰


#### 2. å»ºç«‹ç‰©ä»¶ (Object Creation)

ç•¶æˆ‘å€‘æœ‰äº†ã€Œè²“å’ªèªªæ˜æ›¸ã€ï¼ˆé¡åˆ¥ï¼‰å¾Œï¼Œå°±å¯ä»¥ç”¨å®ƒä¾†è£½é€ è²“å’ªï¼ˆç‰©ä»¶ï¼‰:

```javascript
// å‰µå»ºæ–°çš„è²“å’ªç‰©ä»¶
const kitty1 = new Cat('å°èŠ±', 'æ©˜è‰²');
const kitty2 = new Cat('å°é»‘', 'é»‘è‰²');

kitty1.meow(); // è¼¸å‡º: å–µï½
kitty2.meow(); // è¼¸å‡º: å–µï½

```

- ä½¿ç”¨ `new` ä¾†å‰µå»ºæ–°ç‰©ä»¶ï¼Œ`constructor` æœƒè‡ªå‹•åŸ·è¡Œä¸¦è¨­å®šåˆå§‹ç‹€æ…‹
- æ¯å€‹ç‰©ä»¶éƒ½æ˜¯ç¨ç«‹çš„å€‹é«”ï¼Œæ“æœ‰è‡ªå·±çš„å±¬æ€§å€¼ï¼Œä½†å…±äº«ç›¸åŒçš„æ–¹æ³•

#### 3. å±¬æ€§èˆ‡æ–¹æ³• (Properties & Methods)

ç‰©ä»¶æœ‰å…©å€‹åŸºæœ¬çµ„æˆéƒ¨åˆ†ï¼š

- å±¬æ€§æ˜¯ç‰©ä»¶çš„ç‰¹å¾µï¼Œä¾‹å¦‚è²“å’ªçš„åå­— `name` å’Œæ¯›è‰² `color`
- æ–¹æ³•æ˜¯ç‰©ä»¶å¯ä»¥åŸ·è¡Œçš„æ“ä½œï¼Œä¾‹å¦‚è²“å’ªçš„å«è² `meow()`

##### 3.1 this é—œéµå­—èˆ‡ç¶å®š

åœ¨æ–¹æ³•ä¸­ï¼Œ`this` é—œéµå­—æŒ‡å‘ç•¶å‰ç‰©ä»¶ï¼Œç”¨ä¾†å­˜å–è©²ç‰©ä»¶çš„å±¬æ€§æˆ–èª¿ç”¨å…¶ä»–æ–¹æ³•ã€‚

> `this` å°±åƒæ˜¯è²“å’ªçš„è‡ªæˆ‘èªçŸ¥ â€”â€” ã€Œé€™æ˜¯æˆ‘çš„åå­—ã€ã€ã€Œé€™æ˜¯æˆ‘çš„ç²¾åŠ›å€¼ã€ã€‚ä¸éæœ‰æ™‚å€™è²“å’ªæœƒæä¸æ¸…æ¥šè‡ªå·±æ˜¯èª°ï¼ˆå°±åƒç¾å¯¦ä¸­çš„è²“å’ªä¸€æ¨£ï¼‰ã€‚

ä½¿ç”¨ `this` æ™‚ï¼Œéœ€è¦ç‰¹åˆ¥æ³¨æ„ä½¿ç”¨ä¸€èˆ¬å‡½æ•¸çš„æƒ…æ³ï¼Œä»¥ä¸‹æ˜¯å¹¾ç¨®å¸¸è¦‹æƒ…æ³çš„æ­£ç¢ºä½¿ç”¨æ–¹å¼ï¼š

1. åŸºæœ¬é¡åˆ¥æ–¹æ³•
    ```javascript
    class Cat {
      constructor(name) {
        this.name = name;
      }
      
      meow() {
        console.log(`${this.name}: å–µï¼`);  // âœ… this æ­£ç¢ºæŒ‡å‘è²“å’ª
      }
    }
    ```
2. ç•°æ­¥æƒ…å¢ƒä¸­çš„ `this`
    ```javascript
    class Cat {
      constructor(name) {
        this.name = name;
      }
      
      delayedMeow() {
        // âŒ éŒ¯èª¤æ–¹å¼ï¼šthis æœƒéºå¤±
        setTimeout(function() {
          console.log(`${this.name}: å–µï¼`);
        }, 1000);
        
        // âœ… æ­£ç¢ºæ–¹å¼ï¼šä½¿ç”¨ç®­é ­å‡½æ•¸
        setTimeout(() => {
          console.log(`${this.name}: å–µï¼`);
        }, 1000);
      }
    }
    ```
3. äº‹ä»¶è™•ç†ä¸­çš„ `this`
    ```javascript
    class Button {
      constructor(text) {
        this.text = text;
      }
      
      // âœ… éœ€è¦è™•ç†äº‹ä»¶æ™‚ä½¿ç”¨ç®­é ­å‡½æ•¸
      handleClick = () => {
        console.log(`æŒ‰éˆ• ${this.text} è¢«é»æ“Š`);
      }
    }
    ```

##### 3.2 æœ€ä½³å¯¦è¸å»ºè­°

ç®­é ­å‡½æ•¸çœ‹èµ·ä¾†å¯ä»¥è§£æ±ºæ‰€æœ‰éŒ¯èª¤æ–¹å¼ï¼Œä½†æ¯å€‹å¯¦ä¾‹éƒ½æœƒå‰µå»ºç¨ç«‹çš„æ–¹æ³•å‰¯æœ¬ï¼Œé€ æˆè¨˜æ†¶é«”ä½¿ç”¨å¢åŠ ï¼Œæ‰€ä»¥éœ€çœ‹æƒ…æ³ä½¿ç”¨ï¼Œä»¥ä¸‹æ˜¯æœ€ä½³å¯¦è¸å»ºè­°ï¼š

1. ä¸€èˆ¬æƒ…æ³ï¼šä½¿ç”¨æ¨™æº–æ–¹æ³•å®šç¾©  
    ```javascript
    class Animal {
      speak() {  // âœ… ä¸€èˆ¬æ–¹æ³•ï¼Œå…±äº«æ–¼åŸå‹éˆ
        console.log(`${this.name} èªªè©±äº†`);
      }
    }
    ```
2. éœ€è¦ç¶å®š this æ™‚ï¼šé¸æ“‡ä»¥ä¸‹æ–¹å¼ä¹‹ä¸€
    ```javascript
    class Widget {
      // æ–¹å¼ä¸€ï¼šåœ¨å»ºæ§‹å‡½æ•¸ä¸­ç¶å®š
      constructor() {
        this.handleEvent = this.handleEvent.bind(this);
      }
      
      // æ–¹å¼äºŒï¼šä½¿ç”¨ç®­é ­å‡½æ•¸ï¼ˆä½†æœƒä½”ç”¨è¼ƒå¤šè¨˜æ†¶é«”ï¼‰
      handleEvent = () => {
        console.log(this.name);
      }
    }
    ```

::info
**è¨˜æ†¶é«”ä½¿ç”¨æç¤º**  
- ä¸€èˆ¬æ–¹æ³•ï¼šæ‰€æœ‰å¯¦ä¾‹å…±äº«åŒä¸€å€‹æ–¹æ³•ï¼Œè¨˜æ†¶é«”æ•ˆç‡é«˜
- ç®­é ­å‡½æ•¸ï¼šæ¯å€‹å¯¦ä¾‹éƒ½æœƒå‰µå»ºç¨ç«‹çš„æ–¹æ³•å‰¯æœ¬ï¼Œåƒ…åœ¨å¿…è¦æ™‚ä½¿ç”¨  
::

#### 4. å°è£èˆ‡ç§æœ‰æˆå“¡ (Encapsulation & Private Members)

ç‚ºäº†ä¿è­·ç‰©ä»¶çš„å…§éƒ¨ç‹€æ…‹ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ç§æœ‰å±¬æ€§å’Œæ–¹æ³•ï¼š

```javascript
class Cat {
  #energy = 100;  // ç§æœ‰å±¬æ€§
  #mood = 100;    // ç§æœ‰å±¬æ€§
  
  constructor(name, color) {
    this.name = name;
    this.color = color;
  }
  
  #updateEnergy() {    // ç§æœ‰æ–¹æ³•
    this.#energy -= 10;
  }
  
  play() {
    if (this.#energy < 20) {
      console.log(`${this.name} å¤ªç´¯äº†ï¼`);
      return;
    }
    this.#updateEnergy();
    console.log(`${this.name} é–‹å¿ƒåœ°ç©è€ä¸­`);
  }
}
```

- ä½¿ç”¨ `#` æ¨™è¨˜ç§æœ‰æˆå“¡
- ç§æœ‰æˆå“¡åªèƒ½åœ¨é¡åˆ¥å…§éƒ¨ä½¿ç”¨ï¼ˆ`#energy`ã€`#mood`ã€`#updateEnergy()`ï¼‰
- æä¾›å…¬é–‹æ–¹æ³•ä¾†å®‰å…¨åœ°æ“ä½œç§æœ‰è³‡æ–™ï¼ˆ`play()`ï¼‰

#### 5. éœæ…‹æ–¹æ³• (Static Methods)

**éœæ…‹æ–¹æ³•å±¬æ–¼é¡åˆ¥æœ¬èº«**ï¼Œè€Œä¸æ˜¯é¡åˆ¥çš„å¯¦ä¾‹ï¼š

```javascript
class Temperature {
  constructor(celsius) {
    this.celsius = celsius;
  }
  get fahrenheit() {
    return this.celsius * 1.8 + 32;
  }
  set fahrenheit(value) {
    this.celsius = (value - 32) / 1.8;
  }

  static fromFahrenheit(value) {
    return new Temperature((value - 32) / 1.8);
  }
}

let temp = new Temperature(22);
console.log(temp.fahrenheit);
// â†’ 71.6
temp.fahrenheit = 86;
console.log(temp.celsius);
// â†’ 30
```

`Temperature.fromFahrenheit()` æ˜¯ä¸€å€‹éœæ…‹æ–¹æ³•ï¼Œå®ƒå¯ä»¥ç”¨è¯æ°ç›´æ¥å»ºç«‹ä¸€å€‹æ–°çš„ `Temperature` å¯¦ä¾‹ï¼Œè€Œä¸éœ€è¦å…ˆå»ºç«‹ä¸€å€‹ `Temperature` å¯¦ä¾‹ï¼Œå†å‘¼å« `setFahrenheit()` æ–¹æ³•ã€‚

```javascript
let boil = Temperature.fromFahrenheit(212);
console.log(boil.celsius);
// â†’ 100
```

##### 5.1 é€™æ¨£æœ‰ä»€éº¼å¥½è™•ï¼Ÿ

1. **æä¾›æ›¿ä»£å»ºæ§‹æ–¹å¼**ï¼šæä¾›å¤šç¨®å»ºæ§‹æ–¹å¼ï¼Œè®“ä½¿ç”¨è€…æœ‰æ›´å¤šå½ˆæ€§
    ```javascript
    // ä½¿ç”¨ä¸€èˆ¬å»ºæ§‹å­
    let temp1 = new Temperature(22);  // ä½¿ç”¨æ”æ°

    // ä½¿ç”¨éœæ…‹æ–¹æ³•
    let temp2 = Temperature.fromFahrenheit(71.6);  // ä½¿ç”¨è¯æ°
    ```
2. **ä¸éœ€è¦å¯¦ä¾‹åŒ–å³å¯æä¾›å…¬ç”¨ç¨‹å¼åŠŸèƒ½**ï¼šé©åˆç”¨æ–¼å·¥å…·å‡½æ•¸ï¼Œèƒ½ç¯€çœè¨˜æ†¶é«”ï¼ˆå¦‚ï¼š`Object.keys()`å¯ä»¥ç›´æ¥å‘¼å«ä½¿ç”¨ï¼‰ã€‚
3. **å‘½åç©ºé–“ç®¡ç†**ï¼šå°‡ç›¸é—œçš„å¸¸æ•¸å’Œæ–¹æ³•çµ„ç¹”åœ¨ä¸€èµ·ï¼Œé¿å…å…¨åŸŸå‘½åç©ºé–“æ±¡æŸ“ã€‚
    ```javascript
    class Config {
      static API_URL = 'https://api.example.com';
      static MAX_RETRY = 3;
      
      static getFullUrl(endpoint) {
        return `${this.API_URL}/${endpoint}`;
      }
    }
    ```

##### 5.2 éœæ…‹æ–¹æ³•çš„ç‰¹æ€§

- ç›´æ¥é€šéé¡åˆ¥å‘¼å«ï¼Œä¸éœ€è¦å»ºç«‹å¯¦ä¾‹
- ç„¡æ³•è¨ªå• `this` é—œéµå­—æ‰€æŒ‡å‘çš„å¯¦ä¾‹
-  å¯ä»¥è¨ªå•å…¶ä»–éœæ…‹æ–¹æ³•å’Œéœæ…‹å±¬æ€§
- å¸¸ç”¨æ–¼å¯¦ä½œå·¥å» æ–¹æ³•æˆ–å…¬ç”¨ç¨‹å¼å‡½æ•¸

##### 5.3 ä»€éº¼æ™‚å€™é©åˆä½¿ç”¨ï¼Ÿ

- ç•¶æ–¹æ³•ä¸éœ€è¦å­˜å–å¯¦ä¾‹ç‹€æ…‹æ™‚
- éœ€è¦æä¾›å·¥å…·å‡½æ•¸æˆ–è¼”åŠ©æ–¹æ³•æ™‚
- å¯¦ä½œå·¥å» æ¨¡å¼æˆ–å»ºæ§‹è¼”åŠ©æ–¹æ³•æ™‚
- ç®¡ç†å…±äº«è³‡æºæˆ–è¨­å®šæ™‚
- éœ€è¦çµ„ç¹”ç›¸é—œåŠŸèƒ½ä½†ä¸éœ€è¦å¯¦ä¾‹åŒ–æ™‚

##### 5.4 å®šç¾©æ–¹å¼

åœ¨æ–¹æ³•å‰åŠ ä¸Š `static` é—œéµå­—

```javascript
class ClassName {
  static methodName() {
    // å¯¦ä½œé‚è¼¯
  }
}
```

#### 6. Getter èˆ‡ Setter

Getter å’Œ Setter æ˜¯ç‰¹æ®Šçš„æ–¹æ³•ï¼Œè®“æˆ‘å€‘èƒ½**ä»¥å­˜å–å±¬æ€§çš„æ–¹å¼ä¾†å‘¼å«æ–¹æ³•**ã€‚ä»¥ä¸‹ä»¥æº«åº¦ç‚ºä¾‹ï¼š

```javascript
class Temperature {
  constructor(celsius) {
    this.celsius = celsius;
  }
  get fahrenheit() {
    return this.celsius * 1.8 + 32;
  }
  set fahrenheit(value) {
    this.celsius = (value - 32) / 1.8;
  }

  static fromFahrenheit(value) {
    return new Temperature((value - 32) / 1.8);
  }
}

let temp = new Temperature(22);
console.log(temp.fahrenheit);
// â†’ 71.6
temp.fahrenheit = 86;
console.log(temp.celsius);
// â†’ 30
```

`Temperature` é¡åˆ¥æœ‰å…©å€‹å±¬æ€§ï¼š`celsius` å’Œ `fahrenheit`ï¼Œå®ƒå…è¨±æˆ‘å€‘ä»¥æ”æ°åŠè¯æ°è®€å–å’Œå¯«å…¥æº«åº¦ï¼Œä½†å®ƒåœ¨å…§éƒ¨åªå­˜å„²æ”æ°ï¼Œä¸¦ä¸”åœ¨è¼¸å…¥æˆ–è®€å–è¯æ°æ™‚é€²è¡Œæ”æ°ä¹‹é–“çš„è½‰æ›ã€‚

##### 6.1 é€™æ¨£æœ‰ä»€éº¼å¥½è™•ï¼Ÿ

1. **å°è£èˆ‡ä¸€è‡´æ€§**ï¼šæº«åº¦è¨ˆå…§éƒ¨åªå­˜å„²æ”æ°ï¼Œä½†ä½¿ç”¨è€…å¯ä»¥ä»¥æ”æ°æˆ–è¯æ°è®€å–å’Œå¯«å…¥ï¼Œé€™æä¾›äº†æ›´é«˜çš„å°è£æ€§ï¼Œä½¿ç”¨è€…ä¸éœ€è¦çŸ¥é“å…§éƒ¨çš„å¯¦ç¾ç´°ç¯€ã€‚
2. **ç°¡åŒ–ä½¿ç”¨è€…ä»‹é¢**ï¼šä½¿ç”¨è€…å¯ä»¥åƒå­˜å–ä¸€èˆ¬å±¬æ€§ä¸€æ¨£æ“ä½œæº«åº¦ï¼š`temp.fahrenheit = 86`ï¼Œè€Œä¸éœ€è¦å‘¼å«è½‰æ›æ–¹æ³•ï¼š`temp.setFahrenheit(86)` æˆ– `temp.celsiusToFahrenheit()`ï¼Œé€™è®“ç¨‹å¼ç¢¼æ›´ç›´è§€ã€æ›´å®¹æ˜“é–±è®€ã€‚
3. **è‡ªå‹•è½‰æ›**ï¼šè½‰æ›é‚è¼¯è¢«å°è£åœ¨é¡åˆ¥å…§éƒ¨ï¼Œä½¿ç”¨è€…ä¸é ˆè¦è¨˜ä½æˆ–è™•ç†è½‰æ›å…¬å¼ï¼Œå¦‚æ­¤ä¹Ÿèƒ½é™ä½å‡ºéŒ¯æ©Ÿæœƒã€‚
   > è©¦æƒ³ï¼Œå¦‚æœæº«åº¦å„²å­˜å™¨åªæœ‰æ”æ°ï¼Œä¸¦ä¸”æ²’æœ‰å°è£è½‰æ›é‚è¼¯ï¼Œè€Œä½ ç›®å‰åªæœ‰è¯æ°ï¼Œå°±å¿…é ˆè¦ä½¿ç”¨`let temp = new Temperature((86-32)/1.8);`ï¼Œé€™æ¨£éº»ç…©åˆå®¹æ˜“å‡ºéŒ¯ã€‚
4. **ç¶­è­·æ€§**ï¼šå¦‚æœéœ€è¦ä¿®æ”¹æº«åº¦çš„è½‰æ›é‚è¼¯ï¼Œåªéœ€è¦åœ¨é¡åˆ¥å…§éƒ¨ä¿®æ”¹ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹æ‰€æœ‰ä½¿ç”¨æº«åº¦è¨ˆçš„ç¨‹å¼ç¢¼ã€‚
5. **å½ˆæ€§æ“´å……**ï¼šå¦‚æœéœ€è¦æ–°å¢å…¶ä»–æº«åº¦å–®ä½ï¼Œåªéœ€è¦æ–°å¢æ–°çš„ getter å’Œ setterï¼Œè€Œä¸éœ€è¦ä¿®æ”¹ç¾æœ‰çš„ç¨‹å¼ç¢¼ã€‚
  
##### 6.2 ä»€éº¼æ™‚å€™é©åˆä½¿ç”¨ï¼Ÿ

- éœ€è¦åœ¨è®€å–/å¯«å…¥å±¬æ€§æ™‚é€²è¡Œé©—è­‰ï¼ˆå¦‚æª¢æŸ¥ç¯„åœï¼‰
- å±¬æ€§å€¼éœ€è¦å³æ™‚è¨ˆç®—ï¼ˆå¦‚è¨ˆç®—é¢ç©ï¼‰
- éœ€è¦åœ¨å­˜å–æ™‚é€²è¡Œæ ¼å¼è½‰æ›ï¼ˆå¦‚æº«åº¦ï¼‰
- æƒ³è¦ä¿è­·å…§éƒ¨è³‡æ–™ï¼Œæä¾›å—æ§åˆ¶çš„å­˜å–æ–¹å¼ï¼ˆå¦‚ç§æœ‰å±¬æ€§ï¼‰

##### 6.3 å®šç¾©æ–¹å¼

1. ä½¿ç”¨ `get` é—œéµå­—å®šç¾© getterï¼š
    ```javascript
    get propertyName() {
      return computedValue;
    }
    ```
2. ä½¿ç”¨ `set` é—œéµå­—å®šç¾© setter:
    ```javascript
    set propertyName(value) {
      // é©—è­‰èˆ‡è™•ç†é‚è¼¯
      this.internalValue = value;
    }
    ```

## ç¹¼æ‰¿èˆ‡æ“´å±•

![ç¹¼æ‰¿èˆ‡æ“´å±•æ¶æ§‹](/img/articles/eloquent-JavaScript/ç¹¼æ‰¿èˆ‡æ“´å±•æ¶æ§‹.svg)

#### 1. é¡åˆ¥ç¹¼æ‰¿ ï¼ˆClass Inheritanceï¼‰

å°±åƒå­©å­ç¹¼æ‰¿çˆ¶æ¯çš„ç‰¹å¾µä¸€æ¨£ï¼ŒJavaScript ä¸­çš„é¡åˆ¥ä¹Ÿå¯ä»¥ç¹¼æ‰¿å…¶ä»–é¡åˆ¥çš„ç‰¹æ€§ã€‚é€™è®“æˆ‘å€‘èƒ½å¤ å»ºç«‹æœ‰å±¤æ¬¡çš„ç¨‹å¼çµæ§‹ï¼Œä¸¦é‡ç”¨å·²æœ‰çš„ç¨‹å¼ç¢¼ã€‚

##### 1.1 extends é—œéµå­—

ä½¿ç”¨ `extends` é—œéµå­—ï¼Œæˆ‘å€‘å¯ä»¥å®šç¾©ä¸€å€‹æ–°çš„é¡åˆ¥ï¼Œå®ƒç¹¼æ‰¿è‡ªå¦ä¸€å€‹é¡åˆ¥ã€‚ä»¥ä¸‹æ˜¯ä¸€å€‹ç°¡å–®çš„ä¾‹å­ï¼š

```javascript
// çˆ¶é¡åˆ¥ï¼šåŠŸå¤«å¤§å¸«
class KungFuMaster {
  punch() { console.log("æ™®é€šçš„æ‰“æ‹³"); }
}

// å­é¡åˆ¥ï¼šæå°é¾
class BruceLee extends KungFuMaster {
  punch() { 
    console.log("é–ƒé›»èˆ¬çš„å¯¸æ‹³ï¼"); 
  }
}
```
åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œ`BruceLee` é¡åˆ¥ç¹¼æ‰¿è‡ª `KungFuMaster` é¡åˆ¥ï¼Œä¸¦ä¸”è¦†å¯«äº† `punch` æ–¹æ³•ã€‚ç•¶æˆ‘å€‘å‰µå»ºä¸€å€‹ `BruceLee` çš„å¯¦ä¾‹ä¸¦å‘¼å« `punch` æ–¹æ³•æ™‚ï¼Œæœƒçœ‹åˆ°ä¸åŒçš„çµæœï¼š

##### 1.2 super å‘¼å«

`super` é—œéµå­—ç”¨æ–¼å‘¼å«çˆ¶é¡åˆ¥çš„åŒåæ–¹æ³•æˆ–å±¬æ€§ã€‚åœ¨å­é¡åˆ¥çš„å»ºæ§‹å­ä¸­ï¼Œæˆ‘å€‘é€šå¸¸æœƒå…ˆå‘¼å«çˆ¶é¡åˆ¥çš„å»ºæ§‹å­ï¼Œä»¥ç¢ºä¿çˆ¶é¡åˆ¥çš„åˆå§‹åŒ–é‚è¼¯è¢«åŸ·è¡Œã€‚ä»¥ä¸‹æ˜¯ä¸€å€‹ä¾‹å­ï¼š

```javascript
class Student extends Person {
  constructor(name, grade) {
    super(name);  // å…ˆå‘¼å«äººé¡åˆå§‹åŒ–
    this.grade = grade;  // å†åŠ å­¸ç”Ÿçš„ç‰¹æ€§
  }
  
  introduce() {
    super.introduce();  // å…ˆä»‹ç´¹äººé¡çš„èº«ä»½ï¼šåå­—ã€æ€§åˆ¥ç­‰ç­‰
    console.log(`æˆ‘æ˜¯${this.grade}å¹´ç´šçš„å­¸ç”Ÿ`);  // è£œå……å­¸ç”Ÿä»‹ç´¹
  }
}
```

##### 1.3 æ–¹æ³•è¦†å¯«ï¼ˆMethod Overridingï¼‰

åœ¨å­é¡åˆ¥ä¸­ï¼Œæˆ‘å€‘å¯ä»¥è¦†å¯«çˆ¶é¡åˆ¥çš„æ–¹æ³•ï¼Œä»¥æä¾›ä¸åŒçš„è¡Œç‚ºã€‚ä»¥ä¸‹æ˜¯ä¸€å€‹ä¾‹å­ï¼š

```javascript
class Cat {
  speak() { return "å–µå–µå–µ"; }
}

class FancyCat extends Cat {
  speak() { return "æœ¬å–µä¸å±‘èˆ‡ä½ èªªè©±ï¼"; }  // å‚²å¬Œçš„è²“å’ªç‰ˆæœ¬
}

const cat = new FancyCat();
console.log(cat.speak());  // "æœ¬å–µä¸å±‘èˆ‡ä½ èªªè©±ï¼"
```

#### 2. åŸå‹ç³»çµ±ï¼ˆPrototype Systemï¼‰

##### 2.1 åŸå‹ç¹¼æ‰¿æ©Ÿåˆ¶ï¼ˆPrototype Inheritanceï¼‰

åœ¨ JavaScript ä¸­ï¼Œç‰©ä»¶å¯ä»¥æœ‰åŸå‹ï¼Œè€ŒåŸå‹ä¹Ÿå¯ä»¥æœ‰åŸå‹ï¼Œå½¢æˆäº†ä¸€å€‹åŸå‹éˆã€‚

![åŸå‹ç¹¼æ‰¿æ©Ÿåˆ¶](/img/articles/eloquent-JavaScript/åŸå‹ç¹¼æ‰¿æ©Ÿåˆ¶.svg)

> æƒ³åƒä¸€å€‹å€’é‡‘å­—å¡”ï¼Œç•¶æˆ‘å€‘æŸ¥æ‰¾ä¸€å€‹å±¬æ€§æ™‚ï¼Œæœƒå¾æœ€åº•å±¤ï¼ˆå…·é«”çš„å¯¦ä¾‹ç‰©ä»¶ï¼‰é–‹å§‹ï¼Œç„¶å¾Œé€å±¤å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å±¬æ€§æˆ–åˆ°é”åŸå‹éˆçš„é ‚ç«¯ï¼ˆObject.prototypeï¼‰ã€‚

```javascript
const animal = {
  eat: function() { return "åƒåƒåƒï¼"; }
};

const rabbit = Object.create(animal);
rabbit.hop = function() { return "è·³è·³è·³ï¼"; };

console.log(rabbit.eat());  // "åƒåƒåƒï¼" (ç¹¼æ‰¿è‡ª animal)
console.log(rabbit.hop());  // "è·³è·³è·³ï¼" (è‡ªå·±çš„æ–¹æ³•)
```

åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œ`rabbit` æ˜¯ `animal` çš„åŸå‹ï¼Œå› æ­¤å®ƒç¹¼æ‰¿äº† `animal` çš„ `eat` æ–¹æ³•ã€‚

##### 2.2 Object.prototype

åœ¨ JavaScript ä¸­ï¼Œæ¯å€‹ç‰©ä»¶éƒ½æœ‰ä¸€å€‹åŸå‹ï¼Œè€Œ `Object.prototype` æ˜¯æ‰€æœ‰ç‰©ä»¶çš„é ‚ç«¯åŸå‹ã€‚å®ƒæä¾›äº†è¨±å¤šå…§å»ºçš„æ–¹æ³•ï¼Œä¾‹å¦‚ `toString()`ã€`hasOwnProperty()` ç­‰ç­‰ã€‚

> é€™å°±åƒæ˜¯æ‰€æœ‰ç”Ÿç‰©çš„ç¥–å…ˆï¼Œé€£äººé¡ã€å‹•ç‰©ã€æ¤ç‰©ã€å¾®ç”Ÿç‰©ç­‰ç­‰ï¼Œéƒ½å¯è¿½æº¯åˆ°é€™å€‹å…±åŒçš„ç¥–å…ˆã€‚

```javascript
console.log({}.toString());  // [object Object]
```

##### 2.3 åŸå‹éˆæŸ¥æ‰¾é †åºï¼ˆPrototype Chainï¼‰

åœ¨ JavaScript ä¸­ï¼Œç•¶æˆ‘å€‘å˜—è©¦è¨ªå•ä¸€å€‹ç‰©ä»¶çš„å±¬æ€§æ™‚ï¼Œå¦‚æœè©²ç‰©ä»¶æœ¬èº«æ²’æœ‰é€™å€‹å±¬æ€§ï¼ŒJavaScript æœƒåœ¨åŸå‹éˆä¸Šç¹¼çºŒå°‹æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°å±¬æ€§æˆ–åˆ°é”åŸå‹éˆçš„é ‚ç«¯ï¼ˆObject.prototypeï¼‰ã€‚

```javascript
const animal = {
  eat: function() { return "åƒåƒåƒï¼"; }
};
const rabbit = Object.create(animal);
rabbit.hop = function() { return "è·³è·³è·³ï¼"; };
console.log(rabbit.eat());  // "åƒåƒåƒï¼" (ç¹¼æ‰¿è‡ª animal)
console.log(rabbit.hop());  // "è·³è·³è·³ï¼" (è‡ªå·±çš„æ–¹æ³•)
```

åœ¨é€™å€‹ä¾‹å­ä¸­ï¼Œ`rabbit` æ˜¯ `animal` çš„åŸå‹ï¼Œå› æ­¤å®ƒç¹¼æ‰¿äº† `animal` çš„ `eat` æ–¹æ³•ã€‚

#### 3. é¡åˆ¥ç¹¼æ‰¿èˆ‡åŸå‹ç¹¼æ‰¿æ¯”è¼ƒ

##### 3.1 å¯¦ç¾æ©Ÿåˆ¶æœ¬è³ªä¸åŒ

- é¡åˆ¥ç¹¼æ‰¿
  ```javascript
  // é¡åˆ¥æ˜¯ä¸€å€‹æ¨¡æ¿
  class Animal {
    constructor(name) {
      this.name = name;  // æ¯å€‹å¯¦ä¾‹éƒ½æœƒè¤‡è£½é€™äº›å±¬æ€§
    }
  }

  class Dog extends Animal {
    bark() {
      console.log('Woof!');
    }
  }

  const dog1 = new Dog('Max');
  const dog2 = new Dog('Bella');
  // dog1 å’Œ dog2 å„è‡ªæ“æœ‰è‡ªå·±çš„ name å±¬æ€§å‰¯æœ¬
  ```
- åŸå‹ç¹¼æ‰¿
  ```javascript
  // ç›´æ¥å‰µå»ºç‰©ä»¶ä¸¦é€£çµ
  const animal = {
    name: 'animal'
  };

  const dog = Object.create(animal);
  dog.bark = function() {
    console.log('Woof!');
  };

  // dog ä¸æœƒè¤‡è£½ animal çš„å±¬æ€§ï¼Œè€Œæ˜¯é€šéé€£çµè¨ªå•
  console.log(dog.name);  // é€šéåŸå‹éˆæŸ¥æ‰¾åˆ° 'animal'
  ```

##### 3.2 é—œéµå€åˆ¥

1. è¨˜æ†¶é«”ä½¿ç”¨
   - é¡åˆ¥ï¼šæ¯å€‹å¯¦ä¾‹éƒ½æœƒè¤‡è£½å±¬æ€§
   - åŸå‹ï¼šå…±äº«åŸå‹ç‰©ä»¶çš„å±¬æ€§ï¼Œä¸è¤‡è£½
2. ä¿®æ”¹å½±éŸ¿
    ```javascript
    // é¡åˆ¥
    class Animal {
      constructor() { this.legs = 4; }
    }
    const dog1 = new Animal();
    const dog2 = new Animal();
    dog1.legs = 3;  // åªå½±éŸ¿ dog1
    console.log(dog2.legs);  // ä»ç„¶æ˜¯ 4

    // åŸå‹
    const animal = { legs: 4 };
    const dog1 = Object.create(animal);
    const dog2 = Object.create(animal);
    animal.legs = 3;  // å½±éŸ¿æ‰€æœ‰ç¹¼æ‰¿çš„ç‰©ä»¶
    console.log(dog2.legs);  // è®Šæˆ 3
    ```
3. é‹è¡Œæ™‚è¡Œç‚º
    ```javascript
    // é¡åˆ¥ - çµæ§‹å›ºå®š
    class Animal {}
    const dog = new Animal();
    // ç„¡æ³•åœ¨é‹è¡Œæ™‚æ”¹è®Š Animal çš„åŸå‹

    // åŸå‹ - å¯å‹•æ…‹ä¿®æ”¹
    const animal = {};
    const dog = Object.create(animal);
    // å¯ä»¥éš¨æ™‚ä¿®æ”¹åŸå‹éˆ
    Object.setPrototypeOf(dog, newProto);
    ```

::info
- é¡åˆ¥ç¹¼æ‰¿åƒæ˜¯ã€Œè¤‡å°æ©Ÿã€ï¼šå‰µå»ºæ–°å¯¦ä¾‹æ™‚æœƒè¤‡è£½æ‰€æœ‰å±¬æ€§
- åŸå‹ç¹¼æ‰¿åƒæ˜¯ã€Œåƒè€ƒæ›¸ã€ï¼šæ‰€æœ‰ç‰©ä»¶å…±äº«åŒä¸€æœ¬æ›¸ï¼Œä¸è¤‡è£½å…§å®¹
::

##### 3.3 æ¯”è¼ƒè¡¨æ ¼

| ç‰¹æ€§       | é¡åˆ¥ç¹¼æ‰¿ï¼ˆClass Inheritanceï¼‰ | åŸå‹ç¹¼æ‰¿ï¼ˆPrototype Inheritanceï¼‰ |
| ---------- | ----------------------------- | --------------------------------- |
| æ¦‚å¿µåŸºç¤   | åŸºæ–¼é¡åˆ¥çš„è—åœ–æ¦‚å¿µ            | åŸºæ–¼ç‰©ä»¶çš„é€£çµæ¦‚å¿µ                |
| ç¹¼æ‰¿æ–¹å¼   | å‚ç›´çš„é¡åˆ¥å±¤æ¬¡çµæ§‹            | æ°´å¹³çš„ç‰©ä»¶éˆçµ                    |
| èªæ³•       | `class` å’Œ `extends`          | `Object.create()` æˆ–åŸå‹éˆ        |
| å±¬æ€§æŸ¥æ‰¾   | åœ¨å¯¦ä¾‹åŒ–æ™‚è¤‡è£½                | é€šéåŸå‹éˆå³æ™‚æŸ¥æ‰¾                |
| éˆæ´»æ€§     | çµæ§‹å›ºå®šï¼Œä¿®æ”¹éœ€è¦æ”¹é¡åˆ¥      | çµæ§‹éˆæ´»ï¼Œå¯å‹•æ…‹ä¿®æ”¹åŸå‹          |
| è¨˜æ†¶é«”ä½¿ç”¨ | æ¯å€‹å¯¦ä¾‹éƒ½è¤‡è£½å±¬æ€§            | å…±äº«åŸå‹ä¸­çš„å±¬æ€§å’Œæ–¹æ³•            |
| æ•ˆèƒ½       | ç›´æ¥è¨ªå•å¯¦ä¾‹å±¬æ€§è¼ƒå¿«          | éœ€è¦åœ¨åŸå‹éˆä¸ŠæŸ¥æ‰¾                |
| ä½¿ç”¨å ´æ™¯   | éœ€è¦æ˜ç¢ºé¡å‹å±¤æ¬¡çš„å¤§å‹æ‡‰ç”¨    | éœ€è¦éˆæ´»æ“´å±•çš„å‹•æ…‹ç³»çµ±            |
| ç¨‹å¼ç¢¼çµ„ç¹” | çµæ§‹æ¸…æ™°ï¼Œæ˜“æ–¼ç¶­è­·            | è¼ƒç‚ºéˆæ´»ä½†å¯èƒ½è¼ƒæ··äº‚              |
| å°è£æ€§     | æ”¯æ´ privateã€protected ç­‰    | ä¸»è¦ä¾è³´é–‰åŒ…å¯¦ç¾ç§æœ‰æ€§            |

## é€²éšæ¦‚å¿µ

![é€²éšæ¦‚å¿µæ¶æ§‹](/img/articles/eloquent-JavaScript/é€²éšæ¦‚å¿µæ¶æ§‹.svg)

#### 1. å¤šå‹æ€§ï¼ˆPolymorphismï¼‰

å¤šå‹æ€§æ˜¯æŒ‡ã€Œä¸åŒé¡å‹çš„ç‰©ä»¶å¯ä»¥é€éç›¸åŒçš„ä»‹é¢è¢«è™•ç†ã€çš„ç¨‹å¼è¨­è¨ˆç‰¹æ€§ã€‚

> æƒ³åƒä¸€å€‹å‹•ç‰©åœ’è£¡çš„é¤µé£Ÿæ™‚é–“ï¼Œæ¯ç¨®å‹•ç‰©éƒ½æœƒã€Œåƒã€ï¼Œä½†åƒç›¸å¤©å·®åœ°é ã€‚

##### 1.1 åŸºæœ¬å®šç¾©

```javascript
// å¤šå‹å…è¨±ä¸åŒç‰©ä»¶åªè¦å¯¦ç¾ç›¸åŒä»‹é¢å°±èƒ½è¢«çµ±ä¸€è™•ç†
function printLength(hasLength) {
  console.log(`é•·åº¦æ˜¯: ${hasLength.length}`);
}

// ä¸åŒé¡å‹ä½†éƒ½æœ‰ length å±¬æ€§
printLength([1, 2, 3]);        // é™£åˆ— - é•·åº¦æ˜¯: 3
printLength("Hello");          // å­—ä¸² - é•·åº¦æ˜¯: 5
printLength({length: 100});    // è‡ªè¨‚ç‰©ä»¶ - é•·åº¦æ˜¯: 100
```

##### 1.2 å¯¦ç¾æ–¹å¼

1. æ–¹æ³•è¦†å¯«ï¼ˆMethod Overridingï¼‰
    ```javascript
    class Animal {
      makeSound() {
        console.log("å‹•ç‰©çš„è²éŸ³");
      }
    }

    class Dog extends Animal {
      makeSound() {
        console.log("æ±ªæ±ª!");
      }
    }

    class Cat extends Animal {
      makeSound() {
        console.log("å–µå–µ~");
      }
    }

    // å¤šå‹æ€§çš„å±•ç¾
    const animals = [new Dog(), new Cat()];
    animals.forEach(animal => animal.makeSound());
    // æ±ªæ±ª!
    // å–µå–µ~
    ```
2. ä»‹é¢å¯¦ç¾
    ```javascript
    // toString æ–¹æ³•çš„å¤šå‹å±•ç¾
    Rabbit.prototype.toString = function() {
      return `ä¸€éš» ${this.type} å…”å­`;
    };

    let killerRabbit = new Rabbit("æ®ºæ‰‹");
    console.log(String(killerRabbit)); // "ä¸€éš»æ®ºæ‰‹å…”å­"
    ```

##### 1.3 å¤šå‹æ€§çš„å„ªé»

1. å½ˆæ€§æ“´å±•
    - æ–°å¢åŠŸèƒ½ä¸éœ€ä¿®æ”¹ç¾æœ‰ç¨‹å¼ç¢¼
    - ç¬¦åˆé–‹æ”¾å°é–‰åŸå‰‡
2. ç¨‹å¼ç¢¼é‡ç”¨
    - å…±ç”¨çš„è¡Œç‚ºå¯å®šç¾©åœ¨çˆ¶é¡åˆ¥
    - ç‰¹æ®Šè¡Œç‚ºåœ¨å­é¡åˆ¥å¯¦ç¾
3. ä»‹é¢çµ±ä¸€
    - ä¸åŒç‰©ä»¶å¯ä»¥æœ‰ç›¸åŒçš„æ“ä½œæ–¹å¼
    - é™ä½ç¨‹å¼ç¢¼è€¦åˆåº¦

##### 1.4 å¯¦éš›æ‡‰ç”¨ç¯„ä¾‹

```javascript
// 1. é™£åˆ—é¡ä»‹é¢
const arrayLike = {
  length: 2,
  0: "A",
  1: "B"
};

// ä»»ä½•å…·æœ‰ length å’Œç´¢å¼•å±¬æ€§çš„ç‰©ä»¶éƒ½èƒ½ä½¿ç”¨é™£åˆ—æ–¹æ³•
Array.prototype.forEach.call(arrayLike, item => {
  console.log(item); // è¼¸å‡º "A" å’Œ "B"
});

// 2. å­—ä¸²è½‰æ›ä»‹é¢
class Temperature {
  constructor(celsius) {
    this.celsius = celsius;
  }
  
  toString() {
    return `${this.celsius}Â°C`;
  }
}

let temp = new Temperature(22);
console.log(`ç¾åœ¨æº«åº¦æ˜¯: ${temp}`); // è‡ªå‹•èª¿ç”¨ toString()
```

##### 1.5 æœ€ä½³å¯¦è¸å»ºè­°

1. è¨­è¨ˆåŸå‰‡
    - å„ªå…ˆè€ƒæ…®ä»‹é¢è¨­è¨ˆ
    - ä¿æŒæ–¹æ³•çš„å–®ä¸€è·è²¬
    - ç¢ºä¿ä»‹é¢çš„ä¸€è‡´æ€§
2. æ³¨æ„äº‹é …
    - é¿å…éåº¦ä½¿ç”¨ç¹¼æ‰¿
    - å„ªå…ˆä½¿ç”¨çµ„åˆè€Œéç¹¼æ‰¿
    - ä¿æŒä»‹é¢ç°¡å–®æ˜ç¢º

#### 2. Map è³‡æ–™çµæ§‹

Map æ˜¯ JavaScript æä¾›çš„ä¸€ç¨®ç‰¹æ®Šè³‡æ–™çµæ§‹ï¼Œç”¨æ–¼å„²å­˜éµå€¼å°ï¼ˆkey-value pairsï¼‰çš„é›†åˆã€‚å°‡å§“åæ˜ å°„åˆ°å¹´é½¡ï¼Œå¦‚ä¸‹ï¼š

```javascript
let ages = new Map();
ages.set("Boris", 39);
ages.set("Liang", 22);
ages.set("JÃºlia", 62);
console.log(ages);  // â†’ Map(3) { 'Boris' => 39, 'Liang' => 22, 'JÃºlia' => 62 }
```

##### 2.1 ç‚ºä»€éº¼ä¸ç”¨ä¸€èˆ¬ç‰©ä»¶ï¼Ÿ

å¯ä»¥å…ˆåƒè€ƒä»¥ä¸‹ä¾‹å­ï¼š

```javascript
let ages = {
  Boris: 39,
  Liang: 22,
  JÃºlia: 62
};

console.log(`JÃºlia is ${ages["JÃºlia"]}`);
// â†’ JÃºlia is 62
console.log("Is Jack's age known?", "Jack" in ages);
// â†’ Is Jack's age known? false
console.log("Is toString's age known?", "toString" in ages);
// â†’ Is toString's age known? true
```

æ˜æ˜æˆ‘å€‘æ²’æœ‰å« toString é€™æ¨£çš„äººï¼é€™æ˜¯å› ç‚º JavaScript çš„ç‰©ä»¶æœƒè‡ªå‹•åŒ…å«ä¸€äº›é è¨­çš„å±¬æ€§ï¼Œä¾‹å¦‚ `toString`ã€‚æ‰€ä»¥ï¼Œæˆ‘å€‘ä¸èƒ½ç”¨ç‰©ä»¶ä¾†å„²å­˜éµå€¼å°ï¼Œå› ç‚ºå®ƒå€‘æœƒè¢«è‡ªå‹•æ·»åŠ åˆ°ç‰©ä»¶ä¸­ã€‚

ç•¶ç„¶ä½ å¯ä»¥ä½¿ç”¨ `Object.create(null)` å‰µå»ºæ²’æœ‰åŸå½¢çš„ç‰©ä»¶ï¼š

```javascript
let ages = Object.create(null);
ages["Boris"] = 39;
console.log("Is toString's age known?", "toString" in ages);
// â†’ Is toString's age known? false
```

ä½†ç•¶æˆ‘å€‘å˜—è©¦ä½¿ç”¨ç‰©ä»¶ä½œç‚ºå±¬æ€§åæ™‚ï¼Œè©²ç‰©ä»¶æœƒè¢«è‡ªå‹•è½‰æ›ç‚ºå­—ä¸²ï¼š

```javascript
let ages = {};
let user1 = { name: "Alice" };
let user2 = { name: "Bob" };

ages[user1] = 25;
ages[user2] = 39;

console.log(ages);  // â†’ { '[object Object]': 39 }
// å…©å€‹ä¸åŒçš„ç‰©ä»¶éƒ½è¢«è½‰æ›æˆç›¸åŒçš„å­—ä¸² '[object Object]'
console.log(ages[user1]); // â†’ 39
console.log(ages[user2]); // â†’ 39
```

ç›¸æ¯”ä¹‹ä¸‹ï¼ŒMap å¯ä»¥ä½¿ç”¨ä»»ä½•é¡å‹ä½œç‚ºéµï¼Œä¸æœƒé€²è¡Œè‡ªå‹•è½‰æ›ï¼š

```javascript
let ages = new Map();
let user1 = { name: "Alice" };
let user2 = { name: "Bob" };

ages.set(user1, 25);
ages.set(user2, 39);

console.log(ages); // â†’ Map(2) { { name: 'Alice' } => 25, { name: 'Bob' } => 39 }
console.log(ages.get(user1)); // â†’ 25
console.log(ages.get(user2)); // â†’ 39
```

##### 2.2 Map çš„åŸºæœ¬æ“ä½œ

Map æä¾›äº†å¤šå€‹å¯¦ç”¨çš„æ–¹æ³•ä¾†æ“ä½œè³‡æ–™ï¼š

```javascript
let ages = new Map();

// è¨­ç½®å€¼
ages.set("Boris", 39);
ages.set("Liang", 22);
ages.set("JÃºlia", 62);

// å–å¾—å€¼
console.log(ages.get("Boris")); // â†’ 39

// æª¢æŸ¥æ˜¯å¦å­˜åœ¨
console.log(ages.has("Liang")); // â†’ true
console.log(ages.has("Jack")); // â†’ false

// åˆªé™¤å€¼
ages.delete("Boris");
console.log(ages.has("Boris")); // â†’ false

// å–å¾— Map å¤§å°
console.log(ages.size); // â†’ 2

// æ¸…ç©º Map
ages.clear();
console.log(ages.size); // â†’ 0
```

##### 2.3 Map çš„è¿­ä»£

Map æä¾›äº†å¤šç¨®è¿­ä»£æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°éæ­·éµå€¼å°ï¼š

```javascript
let ages = new Map([
  ["Boris", 39],
  ["Liang", 22],
  ["JÃºlia", 62]
]);

// å–å¾—æ‰€æœ‰çš„éµï¼ˆkeysï¼‰
for (let name of ages.keys()) {
  console.log(name);
}
// â†’ Boris
// â†’ Liang
// â†’ JÃºlia

// å–å¾—æ‰€æœ‰çš„å€¼ï¼ˆvaluesï¼‰
for (let age of ages.values()) {
  console.log(age);
}
// â†’ 39
// â†’ 22
// â†’ 62

// å–å¾—æ‰€æœ‰çš„é …ç›®ï¼ˆentriesï¼‰
for (let [name, age] of ages.entries()) {
  console.log(`${name} is ${age}`);
}
// â†’ Boris is 39
// â†’ Liang is 22
// â†’ JÃºlia is 62

// ä½¿ç”¨ forEach
ages.forEach((age, name) => {
  console.log(`${name} is ${age}`);
});
// â†’ Boris is 39
// â†’ Liang is 22
// â†’ JÃºlia is 62
```

##### 2.4 Map çš„è½‰æ›

Map å¯ä»¥å¾ˆå®¹æ˜“åœ°èˆ‡é™£åˆ—å’Œç‰©ä»¶äº’ç›¸è½‰æ›ï¼š

```javascript
// å¾é™£åˆ—å‰µå»º Map
let pairs = [["name", "Boris"], ["age", 39]];
let userInfo = new Map(pairs);

// Map è½‰æ›ç‚ºé™£åˆ—
let pairsArray = Array.from(userInfo);
console.log(pairsArray); // â†’ [["name", "Boris"], ["age", 39]]

// Map è½‰æ›ç‚ºç‰©ä»¶
let obj = Object.fromEntries(userInfo);
console.log(obj); // â†’ {name: "Boris", age: 39}

// ç‰©ä»¶è½‰æ›ç‚º Map
let objToMap = new Map(Object.entries(obj));
```

##### å°çµ

ç›¸æ¯”æ™®é€šç‰©ä»¶ï¼ŒMap æä¾›äº†æ›´å¤šçš„å…§å»ºæ–¹æ³•å’Œæ›´å¥½çš„å½ˆæ€§ï¼Œç‰¹åˆ¥é©åˆç”¨æ–¼éœ€è¦é »ç¹å¢åˆªæ”¹æŸ¥çš„å ´æ™¯ï¼Œæˆ–æ˜¯éœ€è¦ä½¿ç”¨éå­—ä¸²é¡å‹ä½œç‚ºéµçš„æƒ…æ³ã€‚

> å»¶ä¼¸é–±è®€ï¼š[Map - JavaScript - MDN Web Docs - Mozilla](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Map){target="_blank"}

#### 3. Symbol

Symbol æ˜¯åœ¨ ES6 ä¸­æ–°å¢çš„ä¸€ç¨®åŸå§‹æ•¸æ“šé¡å‹ï¼Œä¸»è¦ç”¨æ–¼å‰µå»ºå”¯ä¸€çš„æ¨™è­˜ç¬¦ã€‚

##### 3.1 åŸºæœ¬ç”¨æ³•

```javascript
// å‰µå»º Symbol
let sym = Symbol("name");
console.log(sym == Symbol("name"));  // â†’ falseï¼ŒSymbol æ°¸é æ˜¯å”¯ä¸€çš„

// ä½œç‚ºç‰©ä»¶å±¬æ€§
Rabbit.prototype[sym] = 55;
console.log(killerRabbit[sym]);  // â†’ 55
```

##### 3.2 Symbol çš„ç‰¹æ€§

1. **å”¯ä¸€æ€§**
   - æ¯å€‹ Symbol éƒ½æ˜¯ç¨ä¸€ç„¡äºŒçš„ï¼Œå³ä½¿æè¿°ç›¸åŒ
   - ç„¡æ³•è¢«è¤‡è£½æˆ–é‡è¤‡å‰µå»º
2. **ä½œç‚ºå±¬æ€§å**ï¼šå¯ä»¥ä½œç‚ºç‰©ä»¶çš„å±¬æ€§åç¨±ï¼Œä¸æœƒèˆ‡å­—ä¸²å±¬æ€§è¡çª
3. **æè¿°æ€§ä½†ä¸å…·å¯¦è³ªæ„ç¾©**ï¼šSymbol å¯ä»¥å¸¶æœ‰æè¿°å­—ä¸²ï¼Œä½†åƒ…ç”¨æ–¼è¾¨è­˜ï¼Œä¸å½±éŸ¿ Symbol çš„å”¯ä¸€æ€§ã€‚

```javascript
// å‰µå»ºå…©å€‹ Symbolï¼Œçµ¦å®ƒå€‘ç›¸åŒçš„ã€Œå§“åã€(æè¿°å­—ä¸²)
let symbol1 = Symbol("æ–¯å¸•");
let symbol2 = Symbol("æ–¯å¸•");

console.log(symbol1 === symbol2);  // â†’ falseï¼Œå³ä½¿ã€Œå§“åã€ç›¸åŒï¼Œä½†æ˜¯ä¸åŒçš„ã€Œèº«åˆ†è­‰è™Ÿç¢¼ã€
```

::info
**ç‚ºä»€éº¼è¦æœ‰æè¿°å­—ä¸²ï¼Ÿ**  
æè¿°å­—ä¸²ä¸»è¦ç”¨æ–¼åœ¨é–‹ç™¼éç¨‹ä¸­å¹«åŠ©é–‹ç™¼è€…ç†è§£ Symbol çš„ç”¨é€”ï¼Œæ–¹ä¾¿é™¤éŒ¯å’Œæé«˜å¯è®€æ€§ã€‚
::

##### 3.3 Symbol.iterator

JavaScript æä¾›çš„å…§å»ºçš„ Symbolï¼Œç”¨æ–¼å®šç¾©ç‰©ä»¶çš„è¿­ä»£è¡Œç‚ºï¼Œè®“ç‰©ä»¶å¯ä»¥ä½¿ç”¨ `for...of` å¾ªç’°ã€‚æˆ‘å€‘ä»¥è‡ªå®šç¾©çš„è³¼ç‰©è»Šé¡åˆ¥ç‚ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ `Symbol.iterator` ä¾†å¯¦ç¾è‡ªå®šç¾©çš„è¿­ä»£è¡Œç‚ºï¼š

```javascript
class ShoppingCart {
    constructor() {
        this.items = [];
    }

    addItem(name, price) {
        this.items.push({ name, price });
    }

    // å¯¦ä½œ Symbol.iterator
    [Symbol.iterator]() {
        let index = 0;
        
        return {
            next: () => {
                if (index < this.items.length) {
                    return {
                        value: this.items[index++],
                        done: false
                    };
                } else {
                    return { done: true };
                }
            }
        };
    }
}

// å‰µå»ºè³¼ç‰©è»Šä¸¦æ·»åŠ å•†å“
const cart = new ShoppingCart();
cart.addItem("è˜‹æœ", 30);
cart.addItem("é¦™è•‰", 25);
cart.addItem("æ©˜å­", 20);

// ä½¿ç”¨ for...of éæ­·è³¼ç‰©è»Š
for (let item of cart) {
    console.log(`${item.name}: $${item.price}`);
}
// â†’ è˜‹æœ: $30
// â†’ é¦™è•‰: $25
// â†’ æ©˜å­: $20

// ä½¿ç”¨å±•é–‹é‹ç®—ç¬¦
const itemArray = [...cart];
console.log(itemArray);
// â†’ [{ name: 'è˜‹æœ', price: 30 }, { name: 'é¦™è•‰', price: 25 }, { name: 'æ©˜å­', price: 20 }]
``` 

- æ–¹æ³•å®šç¾©ï¼šä½¿ç”¨ `[Symbol.iterator]()` ä½œç‚ºæ–¹æ³•åç¨±
- å›å‚³å€¼ï¼šæ–¹æ³•å¿…é ˆå›å‚³ä¸€å€‹è¿­ä»£å™¨ç‰©ä»¶ï¼Œé€™å€‹ç‰©ä»¶éœ€è¦æœ‰ï¼š
  - `next()` æ–¹æ³•
  - `next()` æ–¹æ³•å¿…é ˆå›å‚³å…·æœ‰ `value` å’Œ `done` å±¬æ€§çš„ç‰©ä»¶
- è¿­ä»£çµæŸï¼šç•¶è¿­ä»£å®Œæˆæ™‚ï¼Œå›å‚³ `{ done: true }`


**ä»€éº¼æ™‚å€™é©åˆä½¿ç”¨ï¼Ÿ**  
- ç•¶ä½ çš„é¡åˆ¥åŒ…å«ä¸€ç³»åˆ—å¯éæ­·çš„å…ƒç´ 
- ç•¶ä½ æƒ³è¦è‡ªå®šç¾©éæ­·çš„é †åºæˆ–æ–¹å¼
- ç•¶ä½ æƒ³è¦è®“ä½ çš„é¡åˆ¥å¯ä»¥ä½¿ç”¨ `for...of`ã€å±•é–‹é‹ç®—ç¬¦ç­‰åŠŸèƒ½

> å»¶ä¼¸é–±è®€ï¼š[Symbol.iterator - JavaScript - MDN Web Docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/iterator){target=_blank}

#### 4. instanceof é‹ç®—å­

`instanceof` é‹ç®—å­ç”¨æ–¼æª¢æŸ¥ä¸€å€‹ç‰©ä»¶æ˜¯å¦æ˜¯ç‰¹å®šé¡åˆ¥çš„å¯¦ä¾‹ã€‚

##### 4.1 åŸºæœ¬ç”¨æ³•

```javascript
class Animal {
    constructor(name) {
        this.name = name;
    }
}

class Dog extends Animal {
    bark() {
        return `${this.name} says woof!`;
    }
}

const myDog = new Dog('Max');

console.log(myDog instanceof Dog);      // true
console.log(myDog instanceof Animal);   // true
console.log(myDog instanceof Object);   // true
console.log(myDog instanceof Array);    // false
```

- åŸºæœ¬å‹åˆ¥æª¢æŸ¥ï¼šåŸºæœ¬å‹åˆ¥ï¼ˆå¦‚ `Number`ã€`String`ã€`Boolean`ï¼‰çš„ `instanceof` å¸¸å›å‚³ `false`ï¼Œé™¤éä½¿ç”¨ `new` å»ºç«‹ç‰©ä»¶ï¼Œå› ç‚ºåŸºæœ¬å‹åˆ¥åœ¨ JavaScript ä¸­æ˜¯åŸå§‹å€¼ï¼Œè€Œä¸æ˜¯ç‰©ä»¶ã€‚
  ```javascript
  const str = "Hello";
  console.log(str instanceof String);     // false
  console.log(new String("Hello") instanceof String);  // true
  ```
- é™£åˆ—æª¢æŸ¥ï¼šé™£åˆ—ä¹Ÿæ˜¯ç‰©ä»¶ï¼Œæ‰€ä»¥ `instanceof` å¯ä»¥ç”¨ä¾†æª¢æŸ¥é™£åˆ—æ˜¯å¦æ˜¯ `Array` çš„å¯¦ä¾‹ã€‚
  ```javascript
  const arr = [1, 2, 3];
  console.log(arr instanceof Array);      // true
  console.log(arr instanceof Object);     // true
  ```

##### 4.2 instanceof çš„åŸç†

`instanceof` çš„é‹ä½œåŸç†æ˜¯æª¢æŸ¥ç‰©ä»¶çš„åŸå‹éˆï¼ˆprototype chainï¼‰ã€‚å®ƒæœƒæ²¿è‘—ç‰©ä»¶çš„ `[[Prototype]]` éˆå‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¦åˆçš„åŸå‹æˆ–åˆ°é”åŸå‹éˆçš„é ‚ç«¯ã€‚

- `instanceof` é‹ç®—å­å¯¦éš›ä¸Šæ˜¯æª¢æŸ¥å³å´æ§‹é€ å‡½æ•¸çš„ `prototype` å±¬æ€§æ˜¯å¦å‡ºç¾åœ¨å·¦å´ç‰©ä»¶çš„åŸå‹éˆä¸Š
- åŸå‹éˆæŸ¥æ‰¾æœƒä¸€ç›´é€²è¡Œåˆ°åŸå‹éˆçš„é ‚ç«¯ï¼ˆ`null`ï¼‰

```javascript
console.log(Object.getPrototypeOf([1, 2, 3]) === Array.prototype);  // â†’ true
console.log(Object.getPrototypeOf(Array.prototype) === Object.prototype);  // â†’ true
console.log(Object.getPrototypeOf(Object.prototype) === null);  // â†’ true
```

## ç¸½çµ

æœ¬æ–‡å¾ç‰©ä»¶å°å‘çš„åŸºæœ¬æ€ç¶­å‡ºç™¼ï¼Œä»‹ç´¹äº† JavaScript ä¸­çš„ç‰©ä»¶å°å‘ç¨‹å¼è¨­è¨ˆæ¦‚å¿µå’Œå¯¦ä½œæŠ€å·§ã€‚é€éé¡åˆ¥å®šç¾©ã€ç¹¼æ‰¿æ©Ÿåˆ¶ã€åŸå‹ç³»çµ±ç­‰æ ¸å¿ƒä¸»é¡Œï¼Œå±•ç¤ºäº†å¦‚ä½•é‹ç”¨ç‰©ä»¶å°å‘æ–¹æ³•ä¾†çµ„ç¹”è¤‡é›œçš„ç¨‹å¼é‚è¼¯ã€‚åŒæ™‚ä¹Ÿæ¢è¨äº† `Map` è³‡æ–™çµæ§‹å’Œ `Symbol` ç­‰ç¾ä»£ JavaScript ç‰¹æ€§ï¼Œèªªæ˜äº†å®ƒå€‘åœ¨å¯¦éš›é–‹ç™¼ä¸­çš„æ‡‰ç”¨å ´æ™¯ã€‚

#### é—œéµè¦é»

- ç‰©ä»¶å°å‘çš„å››å¤§æ”¯æŸ±ï¼šå°è£ã€ç¹¼æ‰¿ã€å¤šå‹å’ŒæŠ½è±¡åŒ–
- JavaScript çš„é¡åˆ¥ç³»çµ±å»ºç«‹åœ¨åŸå‹ç¹¼æ‰¿ä¹‹ä¸Š
- é©ç•¶ä½¿ç”¨å°è£å¯ä»¥æé«˜ç¨‹å¼ç¢¼çš„å¯ç¶­è­·æ€§
- `Map` å’Œ `Symbol` ç­‰ç¾ä»£ç‰¹æ€§æä¾›äº†æ›´å¼·å¤§çš„ç¨‹å¼è¨­è¨ˆå·¥å…·
- åˆç†é‹ç”¨å¤šå‹å¯ä»¥æå‡ç¨‹å¼ç¢¼çš„å½ˆæ€§å’Œå¯æ“´å±•æ€§

ä»¥ä¸Šå…§å®¹æ˜¯åŸºæ–¼ [6. The Secret Life of Objects - Eloquent JavaScript 4th edition (2024)](https://eloquentjavascript.net/06_object.html){target=_blank} æ‰€æ•´ç†çš„ç²¾ç°¡ç­†è¨˜ã€‚